# Code for MMHP model

This repository contains the code for the following paper including numerical examples and real data study:

- Markov-Modulated Hawkes Processes for Sporadic and Bursty Event Occurances

Modeling event dynamics is central to many disciplines. Patterns in observed event arrival times are commonly modeled using point processes. Such event arrival data often exhibits self-exciting, heterogeneous and sporadic trends, which is challenging for conventional models. It is reasonable to assume that there exists a hidden state process that drives different event dynamics at different states. In this paper, we propose a Markov Modulated Hawkes Process (MMHP) model for learning such a mixture of event dynamics and develop corresponding inference algorithms. Numerical experiments using synthetic data and data from an animal behavior study demonstrate that MMHP with the proposed estimation algorithms consistently recover the true hidden state process in simulations, and separately captures distinct event dynamics that reveal interesting social structures in the real data.

The structure of this repository is as follows:

- code
	- `main.Rmd`: the detailed R scripts withe explanation that to generate the results shown in the paper. 
	- `main.html`: [preview](https://htmlpreview.github.io/?https://github.com/wendy9217/MMHP/blob/master/code/main.html)

- lib
	- Rcode: directory containing the R functions that are called from `main.Rmd` scripts. 

- data
	- Rdata: include 10 cohorts mice interaction data. 
	- **Reference**: Williamson, C. M., Lee, W., and Curley, J. P. (2016). Temporal dynamics of social hierarchy formation and maintenance in male mice. Animal Behaviour, 115:259â€“272.
  
- fig
	-  fig: Directory containing figures generated by the scripts and shown in the paper.

